---
title: "a6_task4_travis_christy"
author: "Travis Christy"
date: "12/6/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
library(broom)
library(ggbeeswarm)
library(effsize)
library(ggpubr)
library(dplyr)
library(plotly)
```

```{r}
# reading in data and creating simplified version
mono_tc <- read_csv(here("data", "mono_lake_annual_levels.csv"), skip = 5) %>% 
  clean_names()

mono_events <- read_csv(here("data", "mono_events_2.csv")) %>% 
  clean_names()
```

```{r}
timeline <- ggplot(data = mono_tc, aes(x = year, y = lake_level_feet_above_sea_level)) +
  geom_line(show.legend = TRUE) +
  labs(x = "Year", y = "Lake Level (ft above sea-level)") +
  geom_hline(yintercept = 6392, color = "cyan4") +
  geom_text(aes(1875, 6392, label = "Stable Level", vjust = -1)) +
  geom_hline(yintercept = 6377, color = "red") +
  geom_text(aes(1875, 6377,label = "Land bridge level", vjust = -1)) +
    scale_x_continuous(breaks = seq(1850, 2020, by = 10))

timeline
```

1994 - set stable level



```{r,}


fig1 <- plot_ly(
  type = "scatter",
  x = mono_tc$year, 
  y = mono_tc$lake_level_feet_above_sea_level,
  name = 'Lake Level (ft above sea-level)',
  mode = "lines",
  line = list(
        color = '#17BECF'
  )) 
fig1 <- fig1 %>%
  add_trace(
    type = "scatter",
    x = mono_tc$year, 
    y = mono_tc$stable_level,
    name = 'Management Level',
    mode = "lines",
    line = list(
        color = '#7F7F7F'
  )) 
fig1 <- fig1 %>%
  add_trace(
    type = "scatter",
    x = mono_tc$year, 
    y = 6377,
    name = 'Predator Land Bridge Level',
    mode = "lines",
    line = list(
        color = 'red'
  )) 
fig1 <- fig1 %>%
  add_trace(
    type = "scatter",
    x = mono_tc$year, 
    y = 6360,
    name = 'Salinity 120/g/L level',
    mode = "lines",
    line = list(
        color = 'darkgoldenrod'
  )) 
fig1 <- fig1 %>%
  add_trace(
    x = 1994,
    y = 6374.6,
    name = "Decision 1631 sets 'Management Label'",
    marker = list(
      color = 'rgb(17, 157, 255)',
      size = 10,
      line = list(
        color = 'rgb(231, 99, 250)',
        width = 2
      )
    ),
    showlegend = T
  )
fig1 <- fig1 %>%
  layout(
    title = "Mono Lake Levels 1850-2017 (CHRISTY 2020)",
    xaxis = list(
        type = 'date',
        tickformat = "%Y"
  ))

fig1
```
**Figure 1:** The Mono Lake Management Level was created in 1994 due to the implications for nesting birds *eared grebes and California gulls" that rely on the safety of internal nesting islands for protection from predators and food. When the water level drops below 6377 ft above sea-level, predators can cross the newly formed land bridge and prey on the nesting birds and offspring. When the water levels drop below 6360 ft above sea-level, salinity levels begin to negatively affect biological food sources for the birds.  
  
---
  
  
**CITATION**: 2020 Mono Lake Committee [URL LINK](https://www.monolake.org/learn/aboutmonolake/savingmonolake/d1631/)   